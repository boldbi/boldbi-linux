/*!
*  filename: custom-domain.min.js
*  version : unknown version
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
function ResetCustomDomainDialog(){$("#custom-domain-name").val("");$(".charge-custom-domain-div").show();$(".validate-custom-domain-div").hide();$(".upload-ssl-certificate-div").hide();$(".domain-registration-success").hide();$("#custom-domain-popup").ejDialog({width:440});$("#custom-domain-popup").ejDialog("refresh")}function validateSSLCertificateForm(){var n=$(".input-ssl-certificate").prop("files"),t=$("#ssl-certificate-password").val(),i=$(".update-input-ssl-certificate").prop("files"),r=$("#update-ssl-certificate-password").val();return $("#certificate-upload-validation-message").text(""),$("#update-certificate-validation-message").text(""),n.length>0&&t.length>0?($(".custom-domain-input").removeClass("has-error"),$("#ssl-certificate-validate-button").removeAttr("disabled"),!0):i.length>0&&r.length>0?($(".custom-domain-input").removeClass("has-error"),$("#update-ssl-certificate-validate-button").removeAttr("disabled"),!0):($("#ssl-certificate-validate-button").attr("disabled",!0),$("#update-ssl-certificate-validate-button").attr("disabled",!0),!1)}function OnCustomDomainOpen(){$("#custom-domain-name").focus()}function OnCustomDomainClose(){ResetCustomDomainDialog()}function OnUpdateSslOpen(){$("#update-ssl-certificate-popup").show();$("#update-ssl-certificate-popup").ejDialog("open")}function OnUpdateSslClose(){ResetUpdateSslDialog()}function UploadSslCertificateFile(){$(".input-file").before(function(){if(!$(this).prev().hasClass("input-ghost")){var n=$("<input type='file' class='input-ssl-certificate' name='sslfile' accept='.pfx' style='visibility:hidden; height:0'>");return n.attr("name",$(this).attr("name")),n.change(function(){n.next(n).find("input").val(n.val().split("\\").pop())}),$(this).find("button.btn-choose").click(function(){n.click()}),$(this).find("button.btn-reset").click(function(){n.val(null);$(this).parents(".input-file").find("input").val("")}),$(this).find("input").css("cursor","pointer"),$(this).find("input").mousedown(function(){return $(this).parents(".input-file").prev().click(),!1}),n}})}function UpdateSslCertificateFile(){$(".update-input-file").before(function(){if(!$(this).prev().hasClass("input-ghost")){var n=$("<input type='file' class='update-input-ssl-certificate' name='sslfile' accept='.pfx' style='visibility:hidden; height:0'>");return n.attr("name",$(this).attr("name")),n.change(function(){n.next(n).find("input").val(n.val().split("\\").pop())}),$(this).find("button.btn-choose").click(function(){n.click()}),$(this).find("button.btn-reset").click(function(){n.val(null);$(this).parents(".update-input-file").find("input").val("")}),$(this).find("input").css("cursor","pointer"),$(this).find("input").mousedown(function(){return $(this).parents(".update-input-file").prev().click(),!1}),n}})}function IsValidDomainName(n){var t=new RegExp(/^((?:(?:(?:\w[\.\-\+]?)*)\w)+)((?:(?:(?:\w[\.\-\+]?){0,62})\w)+)\.(\w{2,6})$/);return t.test(n)}function buyCustomDomain(){if(!(isCardExist.toLowerCase()==="true")){if($("#card-pay-now-button").attr("disabled",!0),!$("#card-form-id").valid()){$("#card-pay-now-button").attr("disabled",!1);card._complete&&cvc._complete&&exp._complete||(document.querySelector(".error>.message").textContent=window.Server.App.Localization.InCompleteCardNumber);return}showWaitingPopup("server-app-container");var o=$("#pay-form-info-fullname").val(),n=$("#name").val(),s=$("#pay-form-info-email").val(),t=$("#pay-form-info-address1").val(),i=$("#pay-form-info-address2").val(),r=$("#pay-form-info-country").val(),u=$("#pay-form-info-city").val(),f=$("#pay-form-info-state").val(),e=$("#pay-form-info-zip").val(),h={name:n!=""?n:undefined,address_line1:t!=""?t:undefined,address_line2:i!=""?i:undefined,address_country:r!=""?r:undefined,address_city:u!=""?u:undefined,address_state:f!=""?f:undefined,address_zip:e!=""?e:undefined};stripe.createToken(card,h).then(function(n){if(n.token){var t=n.token.card;$.ajax({url:createSubscriptionCardUrl,type:"POST",data:{token:n.token.id,fullName:o,email:s,addressLine1:t.address_line1,addressLine2:t.address_line2,city:t.address_city,state:t.address_state,country:t.address_country,zip:t.address_zip},success:function(n){if(n.Status)$(".validate-custom-domain-div").show(),$("#custom-domain-name").removeAttr("disabled").val(""),isCardExist="true",hideWaitingPopup("server-app-container");else{hideWaitingPopup("server-app-container");$("#card-pay-now-button").attr("disabled",!1);var t=$("#upgradecard-details .validation-error");n.ErrorCode?t.html(window.Server.App.Localization.RetryPaymentFailDescription.format(n.ErrorCode+" â€“ <a href='"+helpSiteBaseUrl+"/site-settings/payments/error-codes' target='_blank'>","<\/a>")):t.html(n.StatusMessage)}}})}else n.error&&n.error.message&&(showCreditcardValidation(n),$("#card-pay-now-button").removeAttr("disabled"),hideWaitingPopup("server-app-container"))})}}function clearCardAndBillingAddressValue(){$(".validation-error").text("");$("#card-form-id").children().find("input").val("");$("#pay-form-info-country").val("default");$("#pay-form-info-country").selectpicker("refresh");$("#name").val("");card.clear();cvc.clear();exp.clear()}function refreshCustomDomainDialogBoxPosition(){var n=$("#custom-domain-popup");n.ejDialog({width:441});n.ejDialog({width:440});n.ejDialog("refresh")}function ResetUpdateSslDialog(){$("#update-ssl-certificate-popup").ejDialog("refresh")}function deleteCustomDomainConfirmation(){onCloseMessageBox();showWaitingPopup("server-app-container");$.ajax({type:"POST",url:deleteCustomDomainUrl,contentType:!1,processData:!1,success:function(n){hideWaitingPopup("server-app-container");n.Status?(successToast(window.Server.App.Localization.DeleteCustomDomainSuccess,7e3),window.location.href=n.Data,onCloseMessageBox()):(warningToast(window.Server.App.Localization.DeleteCustomDomainWarning),onCloseMessageBox())}})}$(document).ready(function(){$("#custom-domain-popup").ejDialog({width:"440px",height:"auto",showOnInit:!1,allowDraggable:!1,enableResize:!1,showHeader:!1,enableModal:!0,open:"OnCustomDomainOpen",close:"OnCustomDomainClose"});$("#update-ssl-certificate-popup").ejDialog({width:"440px",height:"auto",showOnInit:!1,allowDraggable:!1,enableResize:!1,showHeader:!1,enableModal:!0,open:"OnUpdateSslOpen",close:"OnUpdateSslClose"});UploadSslCertificateFile();UpdateSslCertificateFile();$(document).on("click","#card-pay-now-button",function(n){n.preventDefault();$("#card-pay-now-button").is(":visible")&&buyCustomDomain()})});$(document).on("click","#add-custom-domain",function(){$("#custom-domain-popup").show();$("#custom-domain-popup").ejDialog("open")});$(document).on("click",".close-custom-domain",function(){$(".custom-domain-input").removeClass("has-error");$("#domain-validation-message").text("");$("#custom-domain-popup").ejDialog("close")});$(document).on("click",".close-update-ssl",function(){$("#update-ssl-certificate-popup").ejDialog("close");$(".domain-registration-success").css("display","none")});$(document).on("click",".registration-success-close",function(){$("#custom-domain-popup").ejDialog("close");showWaitingPopup("server-app-container");location.reload()});$(document).on("click","#custom-domain-buy-button",function(){$(".charge-custom-domain-div").hide();isCardExist.toLowerCase()==="true"?($(".validate-custom-domain-div").show(),$("#custom-domain-name").removeAttr("disabled").val(""),refreshCustomDomainDialogBoxPosition()):($("#custom-domain-popup").ejDialog({width:560}),$("#custom-domain-popup").ejDialog("refresh"),$("#pay-form-info-fullname").focus())});$(document).on("click","#ssl-certificate-validate-back",function(){$(".validate-custom-domain-div").show();$(".upload-ssl-certificate-div").hide()});$(document).on("click",".custom-domain-link-copy",function(){var n=$(".custom-domain-link-copy");$(".custom-domain-link").select();/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)?n.removeClass("su su-copy").attr("data-original-title",""):(document.execCommand("copy"),n.tooltip("hide").attr("data-original-title",window.Server.App.Localization.Copysuccess).tooltip("fixTitle").tooltip("show"),setTimeout(function(){n.attr("data-original-title",window.Server.App.Localization.LinkCopy);n.tooltip()},7e3))});$(document).on("keyup","#custom-domain-name",function(n){this.value=this.value.toLowerCase();var t=$("#custom-domain-name").val().trim();t.length>0&&IsValidDomainName(t)?($(".custom-domain-input").removeClass("has-error"),$("#custom-domain-validate-button").removeAttr("disabled"),n.which==13&&$("#custom-domain-validate-button").click()):$("#custom-domain-validate-button").attr("disabled",!0)});$(document).on("keyup","#ssl-certificate-password",function(n){validateSSLCertificateForm()&&n.which==13&&$("#ssl-certificate-validate-button").click()});$(document).on("keyup","#update-ssl-certificate-password",function(n){validateSSLCertificateForm()&&n.which==13&&$("#update-\tssl-certificate-validate-button").click()});$(document).on("change",".input-ssl-certificate",function(){validateSSLCertificateForm()});$(document).on("click","#custom-domain-validate-button",function(){$("#custom-domain-name, #custom-domain-validate-button").attr("disabled",!0);$("#domain-validation-message").text("");var n=$("#custom-domain-name").val().trim();n.length>0&&IsValidDomainName(n)&&($("#custom-domain-validate-button").append($("<span class='col-sm-4 no-padding loader-gif'><div class='loader-blue loader-icon' id='schedule-name-validation-loader-icon'><svg class='circular'><circle class='path' cx='27' cy='27' r='10' fill='none' stroke-width='4' stroke-miterlimit='10'><\/circle><\/svg><\/div><\/span>")),$.ajax({type:"POST",url:validateCustomDomainUrl,data:{customHostName:n},success:function(n){$("#custom-domain-name").removeAttr("disabled");$("span.loader-gif").remove();n.Status?($(".validate-custom-domain-div").hide(),$(".upload-ssl-certificate-div").show(),$(".input-ssl-certificate, .ssl-browsefile-input, #ssl-certificate-password").val(""),$("#certificate-upload-validation-message").text(""),$("#ssl-certificate-validate-button").attr("disabled",!0)):($(".custom-domain-input").addClass("has-error"),$("#domain-validation-message").text(n.StatusMessage),$("#custom-domain-name").focus())},error:function(){$("#custom-domain-name").removeAttr("disabled")}}))});$(document).on("click","#ssl-certificate-validate-button",function(){if(validateSSLCertificateForm()){$("#ssl-certificate-validate-button").append($("<span class='col-sm-4 no-padding loader-gif'><div class='loader-blue loader-icon' id='schedule-name-validation-loader-icon'><svg class='circular'><circle class='path' cx='27' cy='27' r='10' fill='none' stroke-width='4' stroke-miterlimit='10'><\/circle><\/svg><\/div><\/span>"));$("#ssl-certificate-password, .ssl-browsefile-button, .ssl-browsefile-input, #ssl-certificate-validate-back, #ssl-certificate-validate-button").attr("disabled",!0);var t=$("#custom-domain-name").val().trim(),n=new FormData,i=$(".input-ssl-certificate")[0].files[0];n.append("pfxBlobArray",i);n.append("password",$("#ssl-certificate-password").val());n.append("customHostName",t);$.ajax({type:"POST",url:addCustomDomainUrl,data:n,contentType:!1,processData:!1,success:function(n){$("span.loader-gif").remove();$("#ssl-certificate-password, .ssl-browsefile-button, .ssl-browsefile-input, #ssl-certificate-validate-back").removeAttr("disabled");$("#ssl-certificate-password").val("");n.Status?($(".upload-ssl-certificate-div").hide(),$(".custom-domain-address").text(t),$(".custom-domain-address").attr("href","https://"+t),$(".valid-until-date").text(n.ExpirationDate),$(".domain-registration-success").show()):$("#certificate-upload-validation-message").text(n.StatusMessage)},error:function(){$("#ssl-certificate-password, .ssl-browsefile-button, .ssl-browsefile-input, #ssl-certificate-validate-back").removeAttr("disabled");$("#ssl-certificate-password").val("")}})}});$(document).on("click","#update-ssl-certificate",function(){$("#update-ssl-certificate-popup").show();$("#update-ssl-certificate-popup").ejDialog("open");$(".upload-ssl-certificate").show()});$(document).on("click","#update-ssl-certificate-validate-button",function(){if(validateSSLCertificateForm()){$("#update-ssl-certificate-password, .ssl-browsefile-button, .ssl-browsefile-input, #update-ssl-certificate-validate-button").attr("disabled",!0);var n=new FormData,t=$(".update-input-ssl-certificate")[0].files[0];n.append("pfxBlobArray",t);n.append("password",$("#update-ssl-certificate-password").val());n.append("customHostName",$(".custom-domain-section .site-url-fields").val());$.ajax({type:"POST",url:updateSslCertificateUrl,data:n,contentType:!1,processData:!1,beforeSend:showWaitingPopup($("#update-ssl-certificate-popup_wrapper")),success:function(n){$("span.loader-gif").remove();$("#update-ssl-certificate-password, .ssl-browsefile-button, .ssl-browsefile-input").removeAttr("disabled");$("#update-ssl-certificate-password").val("");n.Status?($(".upload-ssl-certificate").hide(),$(".registration-success-description").css("display","none"),$(".valid-until-date").text(n.ExpirationDate),$(".domain-registration-success").show()):$("#update-certificate-validation-message").text(n.StatusMessage);hideWaitingPopup($("#update-ssl-certificate-popup_wrapper"))},error:function(){$("#update-ssl-certificate-password, .ssl-browsefile-button, .ssl-browsefile-input").removeAttr("disabled");$("#update-ssl-certificate-password").val("");hideWaitingPopup($("#update-ssl-certificate-popup_wrapper"))}})}});$(document).on("click","#delete-custom-domain",function(){messageBox("su-delete",window.Server.App.Localization.DeleteCustomDomain,window.Server.App.Localization.DeleteCutomDomainConfirm,"error",function(){deleteCustomDomainConfirmation()},function(){onCloseMessageBox()},"448px","180px","150px","")})