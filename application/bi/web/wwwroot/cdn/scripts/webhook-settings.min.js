/*!
*  filename: webhook-settings.min.js
*  version : unknown version
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
function setTimpickerValue(){webhookActivityLogTimeFomat=="True"?(webhookLogStartDateTime="00:00",webhookLogEndDateTime="23:59"):(webhookLogStartDateTime="12:00 AM",webhookLogEndDateTime="11:59 PM")}function openWebhookLogDetails(){var t=angular.element("[ng-controller=WebhookLogInfoCtrl]").scope(),n=$("#webhookLogGrid").ejGrid("instance"),i=n.getCurrentViewData()[n.getIndexByRow($("tr.e-row[aria-selected *='true']"))];showWaitingPopup($("#server-app-container"));$.ajax({type:"GET",url:getWebhookLogDetails,data:{webhookLogId:i.Id},success:function(n){n.status&&(t.openWebhookLogInfoDialog(n.Data),n.FileContent!=""&&($("#download-file-content").text(n.FileName),$("#download-file-content").attr("data-original-title",n.FileName),$("#download-file-content").attr("href",n.FileContent),$("#download-file-content").attr("download",n.FileName),$("[data-toggle='tooltip']").tooltip()),hideWaitingPopup($("#server-app-container")))}})}function fnWebhookLogActionBegin(n){var r=[],t,i;if(n.model.filterSettings.filteredColumns.length>0){for(t=0;t<n.model.filterSettings.filteredColumns.length;t++)i=n.model.filterSettings.filteredColumns[t],r.push({PropertyName:i.field,FilterType:i.operator,FilterKey:i.value});this.model.query._params.push({key:"filterCollection",value:r})}}function DateRangeLocalization(){var n={customPicker:window.Server.App.Localization.CustomPicker,watermarkText:window.Server.App.Localization.SelectRange};typeof BoldBIDashboard!="undefined"?BoldBIDashboard.DateRangePicker.Locale["en-US"]=n:ej.DateRangePicker.Locale["en-US"]=n}function fnOnGridLoad(n){n.model.dataSource.adaptor=new ej.UrlAdaptor;n.model.enableTouch=!1}function fnActionBegin(n){var u,r,t,f,i;if(isFirstRequest=!0,u=$("#search-webhooks-grid").val(),this.model.query._params.push({key:"searchKey",value:u}),r=[],f=createLoader("webhooksGridSettings"),this.element.ejWaitingPopup({template:$("#"+f)}),n.model.filterSettings.filteredColumns.length>0){for(t=0;t<n.model.filterSettings.filteredColumns.length;t++)i=n.model.filterSettings.filteredColumns[t],r.push({PropertyName:i.field,FilterType:i.operator,FilterKey:i.value});this.model.query._params.push({key:"filterCollection",value:r})}}function rowBound(){isFirstRequest&&(isFirstRequest=!1)}function getDeleteWebhookDetails(n){$.ajax({type:"POST",url:deleteWebhookDetailsUrl,data:{webhookId:n},success:function(n){$("#item-delete-confirmation").html(n);$("#delete-popup-container .dialog-body").addClass("text-left").removeClass("text-center");ejs.popups.hideSpinner(document.getElementById("delete-item-dialog"))}})}function deletewebhookConfirmation(){ejs.popups.showSpinner(document.getElementById("delete-item-dialog"));var t=$("#delete-webhook").attr("data-item-id"),n=$(".item-name").html();$.ajax({type:"POST",url:deleteWebhookConfirmationUrl,data:{webhookId:t},success:function(t){var i,r;t.status?(ejs.popups.hideSpinner(document.getElementById("delete-item-dialog")),successToast(window.Server.App.Localization.DeleteSuccess.format(n),7e3),i=$("#webhooksGridSettings").data("ejGrid"),i.refreshContent()):($("#item-delete-confirmation_wrapper").ejWaitingPopup("hide"),warningToast(t.permissionDenied!=undefined&&t.permissionDenied?window.Server.App.Localization.PermissionWarningAlert:window.Server.App.Localization.DeleteWebhookFailMessage.format(n),t.permissionDenied!=undefined&&t.permissionDenied?null:t.message,null,window.Server.App.Localization.DeleteWebhook));r=document.getElementById("delete-item-dialog").ej2_instances;r[0].hide()}})}function activateWebhook(n){$.ajax({type:"POST",url:window.activateWebhookUrl,data:{webhookId:n},success:function(n){n.status?(refreshWehbookGrid(),ShowWaitingProgress(".share-popup-header","hide"),successToast(window.Server.App.Localization.ActivateWebhookSuccess,7e3)):warningToast(n.permissionDenied!=undefined&&n.permissionDenied?window.Server.App.Localization.PermissionWarningAlert:window.Server.App.Localization.ActivateWebhookFailed,n.permissionDenied!=undefined&&n.permissionDenied?null:n.message,null,window.Server.App.Localization.ActivateWebhook)}})}function deactivateWebhook(n){$.ajax({type:"POST",url:deactivateWebhookUrl,data:{webhookId:n},success:function(n){n.status?(refreshWehbookGrid(),ShowWaitingProgress(".share-popup-header","hide"),successToast(window.Server.App.Localization.DeactivateWebhookSuccess,7e3)):warningToast(n.permissionDenied!=undefined&&n.permissionDenied?window.Server.App.Localization.PermissionWarningAlert:window.Server.App.Localization.DeactivateWebhookFailed,n.permissionDenied!=undefined&&n.permissionDenied?null:n.message,null,window.Server.App.Localization.DeactivateWebhook)}})}function refreshWehbookGrid(){if($("#webhooksGridSettings").ejWaitingPopup("show"),$(".default-pages").length===1)$("#body").ejWaitingPopup("show"),location.reload();else{var n=$("#webhooksGridSettings").data("ejGrid");n.refreshContent()}}var isFirstRequest=!1,isItemDeleteDialogBinded=!1,webhookLogStartDateTime="",webhookLogEndDateTime="";$(document).ready(function(){$("[data-toggle='tooltip'], .selectpicker").tooltip();$("#datePicker").ejDateRangePicker({dateFormat:webhookActivityLogDateFormat,locale:"en-US",buttonText:{apply:window.Server.App.Localization.Apply,cancel:window.Server.App.Localization.CancelButton,reset:window.Server.App.Localization.Reset},ranges:[{label:window.Server.App.Localization.Today,range:[new Date,new Date]},{label:window.Server.App.Localization.Yesterday,range:[new Date((new Date).setDate((new Date).getDate()-1)),new Date((new Date).setDate((new Date).getDate()-1))]},{label:window.Server.App.Localization.LastDays.format("7"),range:[new Date((new Date).setDate((new Date).getDate()-7)),new Date]},{label:window.Server.App.Localization.LastDays.format("15"),range:[new Date((new Date).setDate((new Date).getDate()-14)),new Date]},{label:window.Server.App.Localization.LastDays.format("30"),range:[new Date((new Date).setMonth((new Date).getMonth()-1)),new Date]},{label:window.Server.App.Localization.LastDays.format("60"),range:[new Date((new Date).setMonth((new Date).getMonth()-2)),new Date]},{label:window.Server.App.Localization.ThisWeek,range:[new Date((new Date).setDate((new Date).getDate()-(new Date).getDay())),new Date((new Date).setDate((new Date).getDate()-(new Date).getDay()+6))]},{label:window.Server.App.Localization.ThisMonth,range:[new Date((new Date).getFullYear(),(new Date).getMonth(),1),new Date((new Date).getFullYear(),(new Date).getMonth()+1,0)]}]})});$(document).on("click","#webhook-log-filter-apply-button",function(){$.ajax({type:"GET",url:integarationPagePermissionUrl,data:{scope:SettingsScopes.Integrations},success:function(n){if(n.status){setTimpickerValue();var t=$("#datePicker").val().split("-"),r=$.trim(t[0])!=""?$.trim(t[0])+" "+webhookLogStartDateTime:"",u=$.trim(t[1])!=""?$.trim(t[1])+" "+webhookLogEndDateTime:"",f=$("#select-webhook-event").val()==null?"":$("#select-webhook-event").val(),i=$("#webhookLogGrid").data("ejGrid"),e=ej.DataManager({url:filterWebhookLogsUrl+"?startDate="+r+"&endDate="+u+"&eventType="+f,adaptor:new ej.UrlAdaptor});i.dataSource(e);i.model.pageSettings.currentPage=1}else n.permissionDenied&&warningToast(window.Server.App.Localization.AdminPageAccessWarningAlert+" "+window.Server.App.Localization.ReloadPage)}})});$(document).on("click",".webhook-log-info",function(){openWebhookLogDetails()});serverApp.controller("WebhookLogInfoCtrl",["$scope","$timeout",function(n,t){n.WebhookLogDetail=null;n.closeItemInfo=function(){$("#webhookLog-info-popup").ejDialog("close")};n.openWebhookLogInfoDialog=function(i){var r=JSON.parse(i.RequestData),u;r.FileContent==undefined?$(".webhook-log-file-content").css("display","none"):$(".webhook-log-file-content").css("display","block");delete r.FileContent;u=JSON.stringify(r,null,2);n.WebhookLogDetail=i;$("#webhookLog-info-popup").ejDialog({width:window.innerWidth>480?"400px":window.innerWidth-10+"px",height:"548px",showOnInit:!1,allowDraggable:!1,enableResize:!1,showHeader:!1,enableModal:!0});$("#webhookLog-info-popup").ejDialog("open");$("#webhookLog-info-popup").ejDialog("refresh");document.getElementById("request-message").innerText=u;t(function(){n.$apply()},100)}}]);$(document).ready(function(){if(window.location.href.indexOf("?isRedirectedFromEdit")>-1){successToast(window.Server.App.Localization.EditWebhookSuccess,7e3);var n=window.location.href;n=n.substring(0,n.lastIndexOf("?"));history.replaceState(null,null,n)}});$(document).on("click",".search-accounts",function(){var n=$("#webhooksGridSettings").data("ejGrid");n.model.pageSettings.currentPage=1;n.refreshContent()});$(document).on("click","#delete-webhook",function(){var r,u,i,t,f,n;$("#delete-item-name").html($(this).attr("data-name"));$("#delete-webhook").attr("data-item-id",$(this).attr("data-item-id"));r=$(this).attr("data-item-id");u=$(this).attr("data-name");document.getElementById("item-delete-confirmation").style.display="block";i='<span class="dialog-header-with-subtitle"><span class ="dialog-header-title">'+window.Server.App.Localization.DeleteWebhook+' <\/span><span class="item-name">'+u+"<\/span><\/span>";isItemDeleteDialogBinded?(n=document.getElementById("delete-item-dialog").ej2_instances,n[0].header=i,n[0].show()):(t=document.createElement("div"),t.setAttribute("id","delete-item-dialog"),f=document.getElementById("webhooksGridSettings"),f.appendChild(t),n=new ejs.popups.Dialog({showOnInit:!1,allowDraggable:!1,enableResize:!1,width:window.innerWidth>460?"450px":window.innerWidth-10,height:"auto",showHeader:!1,animationSettings:{effect:"Zoom"},isModal:!0,enableModal:!0,closeOnEscape:!0,header:i,showCloseIcon:!0,content:document.getElementById("item-delete-confirmation"),buttons:[{click:function(){deletewebhookConfirmation()},buttonModel:{cssClass:"app-btn-danger",content:window.Server.App.Localization.YesButton}},{click:function(){n.hide()},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.Localization.NoButton}}]}),n.appendTo(t),isItemDeleteDialogBinded=!0);ejs.popups.createSpinner({target:document.getElementById("delete-item-dialog")});ejs.popups.setSpinner({type:"Material"});ejs.popups.showSpinner(document.getElementById("delete-item-dialog"));getDeleteWebhookDetails(r)});$(document).on("click",".deactivate-webhook",function(){$(".deactivate-webhook").attr("data-item-id",$(this).attr("data-item-id"));var n=$(this).attr("data-item-id");deactivateWebhook(n)});$(document).on("click",".activate-webhook",function(){$(".activate-webhook").attr("data-item-id",$(this).attr("data-item-id"));var n=$(this).attr("data-item-id");activateWebhook(n)});$.views.converters("toLowerCase",function(n){return n.toLowerCase()})