/*!
*  filename: schedulerrecipients.min.js
*  version : unknown version
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
function getAllStaticData(){window.userList==undefined&&$.ajax({type:"POST",url:getActiveandInactiveUserUrl,data:{},async:!1,success:function(n){window.userList=n.data.users;window.groupList=n.data.groups}});$("#user-search").append(window.userList);$("#group-search").append(window.groupList);$(".selectpicker").selectpicker("refresh");$("#schedule-submit").attr("data-report-id",createdItemId);$(".share-popup .bs-deselect-all").after("<div class='bs-select-all-custom'><span>"+window.Server.App.Localization.Select+"<\/span><span class='bs-select-custom-tick glyphicon glyphicon-ok' ><\/span><\/div>");$("#user-search-container .bootstrap-select .bs-searchbox .input-block-level").attr("placeholder",window.Server.App.Localization.SearchUsers);$("#group-search-container .bootstrap-select .bs-searchbox .input-block-level").attr("placeholder",window.Server.App.Localization.SearchGroups)}function validateExternalRecipient(){$(document).on("keypress","#external-email",function(n){n.which==13&&(n.preventDefault(),$("#external-submit").click())});$(document).on("click","#external-submit",function(){var n=$("#external-email").val().toLowerCase(),i=$(".selected-recipients").children(),r,t;if(IsEmail(n)){for(r=$("<div>").attr("id",n).attr("data-searchtype","externalRecipient").addClass("SelectedShareItems"),r.html("<div class='InstantSearch'><span class='details' title='"+n+"'>"+n+"<\/span><div style='width:auto' class='instant-cancel'><span class='su su-close i-selected-cancel'/><\/div><\/div>"),t=0;t<i.length;t++)if(i[t].getAttribute("data-searchtype")=="externalRecipient"&&n==i[t].id){$("#external-email").addClass("inactive-box");$("#external-submit").addClass("inactive-icon");$("#external-email-validation").html("<span class='validate-fail'>"+window.Server.App.Localization.IsMailExist+"<\/span>");return}$("#selected-users-validation").css("visibility","hidden");$("#selected-users").append(r);$("#external-email").val("");selectedItemsCount()}else n!=""?($("#external-email").addClass("inactive-box"),$("#external-submit").addClass("inactive-icon"),$("#external-email-validation").html("<span class='validate-fail'>"+window.Server.App.Localization.IsValidEmail+"<\/span>")):($("#external-email").removeClass("inactive-box"),$("#external-submit").removeClass("inactive-icon"),$("#external-email-validation").html())});$(document).on("keyup","#external-email",function(n){n.keyCode!=13&&($("#external-email").removeClass("inactive-box"),$("#external-submit").removeClass("inactive-icon"),$("#external-email-validation").html(""))})}function selectedItemsCount(){$("#selected-users-info").html("<span class='pull-left'>"+window.Server.App.Localization.ScheduleMembers.format($(".SelectedShareItems[data-searchtype='userSearch']").length,$(".SelectedShareItems[data-searchtype='groupSearch']").length,$(".SelectedShareItems[data-searchtype='externalRecipient']").length)+"<span>").css({"padding-top":"10px","padding-left":"15px","margin-top":"0"})}function scheduleSubmit(n,t,i,r,u,f,e,o,s,h,c,l){n.length||$("#export-destination").prop("checked")?$.ajax({type:"POST",url:u,data:{scheduleList:JSON.stringify({ScheduleItem:f,UserList:e,GroupList:o,ExternalRecipientList:s,result:t,alert:alertChange,DataSourceId:l,FilterData:h,DaJsonString:c})},beforeSend:function(){parent.$("#popup-container_wrapper").ejWaitingPopup("show");parent.$("#editpopup-container_wrapper").ejWaitingPopup("show")},success:function(n){var o,e,i,u,t;if(n.Success){scheduleDetail=createScheduleMessage(!0);parent.$("#popup-container_wrapper").ejWaitingPopup("hide");parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide");i=$(".schedule-popup-title").text();closePopupContainer();r=r==""?".":r;var u=successMessage+(l==""?" ":"")+scheduleDetail+(l==""?".":r),s=u.length>140?"success-message-large":"success-message-small",h='<span class="dialog-header-with-icon"><span class ="dialog-header-title"><i class="su su-calendar-1 dialog-header-icon"><\/i>&nbsp;&nbsp;'+i+"<\/span><\/span>",f=document.createElement("div");f.setAttribute("id","schedule-success-dialog");o=parent.document.getElementById("server-app-container");o.appendChild(f);e=new parent.ejs.popups.Dialog({showOnInit:!1,allowDraggable:!1,enableResize:!1,width:window.innerWidth>460?"450px":window.innerWidth-10,height:"auto",showHeader:!1,animationSettings:{effect:"Zoom"},isModal:!0,enableModal:!0,closeOnEscape:!0,header:h,showCloseIcon:!0,content:u,buttons:[{click:function(){if(typeof parent.refreshScheduleGrid=="function"&&parent.refreshScheduleGrid(),parent.$("#on-board-schedule-dashboard").length>0&&!parent.$("#on-board-share-dashboard").hasClass("journey-done")){parent.$("#on-board-schedule-dashboard").addClass("journey-done").removeAttr("id");var n=parseInt(parent.$(".progress-bar-success").attr("data-progress-percentage"))+parseInt(parent.$(".progress-bar-success").attr("data-increment"));parent.$(".progress-bar-success").css("width",n+"%").attr("data-progress-percentage",n);parent.$(".progress-bar-percentage").text(n+"%")}e.hide()},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.Localization.OKButton}}]},s);e.appendTo(f)}else n.HasPermission==undefined||n.HasPermission?n.ScheduleNameAlreadyExist!=undefined&&n.ScheduleNameAlreadyExist&&(parent.$("#popup-container_wrapper").ejWaitingPopup("hide"),parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide"),closePopupContainer(),warningToast(window.Server.App.Localization.IsScheduleExist)):(parent.$("#popup-container_wrapper").ejWaitingPopup("hide"),parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide"),i=$(".schedule-popup-title").text(),closePopupContainer(),u=schedulePermisionWarningMessage,warningToast(schedulePermisionWarningMessage),typeof parent.refreshScheduleGrid=="function"&&parent.refreshScheduleGrid(),parent.$("#on-board-schedule-dashboard").length>0&&!parent.$("#on-board-share-dashboard").hasClass("journey-done")&&(parent.$("#on-board-schedule-dashboard").addClass("journey-done").removeAttr("id"),t=parseInt(parent.$(".progress-bar-success").attr("data-progress-percentage"))+parseInt(parent.$(".progress-bar-success").attr("data-increment")),parent.$(".progress-bar-success").css("width",t+"%").attr("data-progress-percentage",t),parent.$(".progress-bar-percentage").text(t+"%")))}}):$("#selected-users-validation").css("visibility","visible")}function FTPCredentialsValidation(n){if((n.target.id=="schedule-submit"&&$("#host-name").val()==""||n.target.id=="host-name"&&$("#host-name").val()=="")&&$("#host-name").closest("div").addClass("has-error"),n.target.id=="schedule-submit"){$("#host-name").val()==""&&($("#host-name").closest("div").addClass("has-error"),$("#host-name").closest("div").find("span").html(window.Server.App.Localization.HostNamevalidator).addClass("ftp-credentials-validation-message"));$("#user-name").val()==""&&($("#user-name").closest("div").addClass("has-error"),$("#user-name").closest("div").find("span").html(window.Server.App.Localization.UserNameValidator).addClass("ftp-credentials-validation-message"));$("#password").val()==""&&($("#password").closest("div").addClass("has-error"),$("#password").closest("div").find("span").html(window.Server.App.Localization.PasswordValidator).addClass("ftp-credentials-validation-message"));return}n.target.id=="host-name"&&$("#host-name").val()==""&&($("#host-name").closest("div").addClass("has-error"),$("#invalid-hostname").html(window.Server.App.Localization.HostNamevalidator).addClass("ftp-credentials-validation-message"));n.target.id=="user-name"&&$("#user-name").val()==""&&($("#user-name").closest("div").addClass("has-error"),$("#invalid-username").html(window.Server.App.Localization.UserNameValidator).addClass("ftp-credentials-validation-message"));n.target.id=="password"&&$("#password").val()==""&&($("#password").closest("div").addClass("has-error"),$("#invalid-password").html(window.Server.App.Localization.PasswordValidator).addClass("ftp-credentials-validation-message"));return}function validateSubscriber(){if(!$("#selected-users").children().length>0)return $("#selectedRecipientErrorContainer").css("display","block"),$("#selectedRecipientValidator").html(window.Server.App.Localization.RecipientValidator),!1;$("#selectedRecipientErrorContainer").css("display","none")}function validateImagedpi(){var t=$("input[name=exportFormats]:checked","#export-format-container").val().toString().toLowerCase(),n;t=="image"?(n=$("#image-dpi").val(),n==0?($("#image-no-value-error").show(),$("#image-dpi-error").hide()):($("#image-no-value-error").hide(),n<=300&&n>=96?($("#image-dpi-error").hide(),$("#schedule-submit").removeAttr("disabled")):($("#schedule-submit").prop("disabled",!0),$("#image-dpi-error").show()))):($("#schedule-submit").removeAttr("disabled"),$("#image-dpi-error").show(),$("#image-no-value-error").hide(),$("#image-dpi").val(96))}function pdfActiveOrientation(){$("#pdf-orientation").on("click",".pdf-orientation-format",function(){$(this).addClass("selected-pdf-orientation").siblings().removeClass("selected-pdf-orientation")})}function excelFormatsShow(){$("#show-excel-format").show();$("#show-image-format").hide();$("#show-pdf-format").hide();validateImagedpi()}function imageFormatShow(){$("#show-image-format").show();$("#show-excel-format").hide();$("#show-pdf-format").hide();validateImagedpi()}function pdfFormatShow(){$("#show-pdf-format").show();$("#show-excel-format").hide();$("#show-image-format").hide();validateImagedpi()}function refreshDropdown(){$("#webhook-select-validations").css("display","none");isNullOrWhitespace($("#webhook-option").val())&&(listWebhooks="");$(document).on("show.bs.dropdown",".select-webhook-div",function(){LoadWebhookName($("#webhook-option option:selected").val())});isNullOrWhitespace($("#webhook-option").val())||$.ajax({type:"POST",url:getWebhookDetailsByIdUrl,data:{webhookId:$("#webhook-option option:selected").val()},success:function(n){$("#webhook-info").css("display","block");$("#webhook-info span").html(window.Server.App.Localization.WebhookInfoMessage.format("<b>"+n.data.Url+"<\/b>","<b>"+n.data.ContentTypeDescription+"<\/b>","POST"))}})}function LoadWebhookName(n){var t=alertChange==2?webhookevent[1]:webhookevent[0];$(".select-webhook-div").find(".open,.bootstrap-select").removeClass("dropdown-alignment");$(".select-webhook-div .bootstrap-select").append($("<span class='no-padding loader-gif'><div class='loader-blue loader-icon' id='category-dropdown-loader-icon'><svg class='circular'><circle class='path' cx='27' cy='27' r='13' fill='none' stroke-width='4' stroke-miterlimit='10'><\/circle><\/svg><\/div><\/span>"));$(".select-webhook-div .bootstrap-select .open").hide();listWebhooks==""?$.ajax({type:"POST",url:getWebhooksUrl,data:{webhookEventType:t},success:function(n){var i=n,t;for(listWebhooks="<option value='' data-hidden='true'><\/option>",t=0;t<i.data.length;t++)listWebhooks+='<option value="'+i.data[t].Id+'">'+i.data[t].Name+"<\/option>";$("#webhook-option").html("");$("#webhook-option").html(listWebhooks);$("#webhook-option").selectpicker("refresh");$(".select-webhook-div.bootstrap-select ul li").each(function(){$(this).hasClass("selected")&&$(this).addClass("active")});i.data.length>0?($(".select-webhook-div .bootstrap-select .open").show(),$("#webhook-select-validations").css("display","none")):($("#webhook-select-validations").html(""),$("#webhook-select-validations").css("display","block").html(window.Server.App.Localization.NoWebhook),$("#webhook-info").css("display","none"));$(".select-webhook-div span.loader-gif").remove()}}):$.ajax({type:"POST",url:getWebhooksUrl,data:{webhookEventType:t},success:function(t){var i=t,u,r;for(listWebhooks="<option value='' data-hidden='true'><\/option>",u=0;u<i.data.length;u++)listWebhooks+='<option value="'+i.data[u].Id+'">'+i.data[u].Name+"<\/option>";for($("#webhook-option").html(""),$("#webhook-option").html(listWebhooks),r=0;r<i.data.length;r++)n!=undefined&&n==i.data[r].Id&&($("#webhook-option option[value='"+i.data[r].Id+"']").attr("selected",!0),$(".select-webhook-div .filter-option").html(i.data[r].Name));$(".select-webhook-div.bootstrap-select ul li").each(function(){$(this).hasClass("selected")&&$(this).addClass("active")});$("#webhook-option").selectpicker("refresh");i.data.length>0?($(".select-webhook-div .bootstrap-select .open").show(),$("#webhook-select-validations").css("display","none")):($("#webhook-select-validations").html(""),$("#webhook-select-validations").css("display","block").html(window.Server.App.Localization.NoWebhook),$("#webhook-info").css("display","none"));$(".select-webhook-div span.loader-gif").remove()}});$(".select-webhook-div").find(".open,.bootstrap-select").addClass("dropdown-alignment")}var listWebhooks="";$(document).on("click","#export-destination",function(){if($("#host-name, #user-name, #password").val("").closest("div").removeClass("has-error"),$("#webhook-select-validations").css("display","none"),$("#invalid-hostname, #invalid-username, #invalid-password").html("").hide(),$("#ftp-validation-message").text("").removeClass("ftp-credentials-validation-message"),$("#selected-users-validation").css("visibility","hidden"),$("#export-destination").prop("checked")){$("#host-name, #user-name, #password, #ftp-destination, #webhook-destination").attr("disabled",!1);$(".select-webhook-div .selectpicker").removeClass("disabled");$("#create-webhook").removeClass("disabled");$("#webhook-option, #refresh-webhook").attr("disabled",!1);$("#webhook-option").selectpicker("refresh");$(document).on("show.bs.dropdown",".select-webhook-div",function(){LoadWebhookName($("#webhook-option option:selected").val())})}else $("#host-name, #user-name, #password,#ftp-destination, #webhook-destination").attr("disabled",!0),$("#webhook-option").find("option").remove(),$("#webhook-option").selectpicker("refresh"),$("#webhook-option").attr("disabled",!0).val(""),$("#refresh-webhook").attr("disabled",!0),$(".select-webhook-div .btn").addClass("disabled"),$("#create-webhook").addClass("disabled"),$("#webhook-info").css("display","none")});$(document).on("change","input[name='destinationType']",function(){$("#host-name, #user-name, #password").val("").closest("div").removeClass("has-error");$("#invalid-hostname, #invalid-username, #invalid-password").html("").hide();$("#ftp-validation-message").text("").removeClass("ftp-credentials-validation-message");$("#webhook-select-validations").css("display","none");$("#webhook-destination").is(":checked")?($(".webhook-location-div").removeClass("hide").addClass("show"),$(".ftp-location-div").removeClass("show").addClass("hide"),$(".select-webhook-div .selectpicker").removeClass("disabled"),$("#create-webhook").removeClass("disabled"),$("#webhook-option, #refresh-webhook").attr("disabled",!1),$("#webhook-option").selectpicker("refresh"),$("#host-name, #user-name, #password").val(""),listWebhooks=""):($("#webhook-info").css("display","none"),$("#host-name, #user-name, #password").attr("disabled",!1),$(".webhook-location-div").removeClass("show").addClass("hide"),$(".ftp-location-div").removeClass("hide").addClass("show"),$("#webhook-option").find("option").remove(),$("#webhook-option").selectpicker("refresh"),$(".select-webhook-div.bootstrap-select ul li").each(function(){$(this).hasClass("selected")&&($(this).removeClass("active"),$(this).removeClass("selected"))}))});$(document).on("click","#user-search-container .bs-select-all-custom",function(n){$("#user-search-container").addClass("value-changed");$("#user-search").data("selectpicker").selectAll();$("#user-search").trigger("change");$(this).removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom");$($(this).children("span")[0]).text(window.Server.App.Localization.Clear);selectedItemsCount();n.stopPropagation()});$(document).on("click","#group-search-container .bs-select-all-custom",function(n){$("#group-search-container").addClass("value-changed");$("#group-search").data("selectpicker").selectAll();$("#group-search").trigger("change");$(this).removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom");$($(this).children("span")[0]).text(window.Server.App.Localization.Clear);selectedItemsCount();n.stopPropagation()});$(document).on("click","#user-search-container .bs-deselect-all-custom",function(n){$("#user-search-container").addClass("value-changed");$("#user-search").data("selectpicker").deselectAll();$("#user-search").trigger("change");$(this).removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom");$($(this).children("span")[0]).text(window.Server.App.Localization.Select);$(".SelectedShareItems[data-searchtype='userSearch']").remove();selectedItemsCount();n.stopPropagation()});$(document).on("click","#group-search-container .bs-deselect-all-custom",function(n){$("#group-search-container").addClass("value-changed");$("#group-search").data("selectpicker").deselectAll();$("#group-search").trigger("change");$(this).removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom");$($(this).children("span")[0]).text(window.Server.App.Localization.Select);$(".SelectedShareItems[data-searchtype='groupSearch']").remove();selectedItemsCount();n.stopPropagation()});$(document).on("change","#user-search",function(n){var t=[],i,r;$("#user-search-container").addClass("value-changed");i=$("#user-search-container .bootstrap-select li.selected").length;r=$("#user-search-container .bootstrap-select li").length;i==r&&($($("#user-search-container div.bs-select-all-custom").children("span")[0]).text(window.Server.App.Localization.Clear),$("#user-search-container div.bs-select-all-custom").removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom"));$(this).find("option").each(function(n,i){var f,e,r,u;if($(this).is(":selected"))r=i,f=$("<div>").attr("id",$(r).val()).attr("data-searchtype","userSearch").addClass("SelectedShareItems"),f.html("<div class='InstantSearch'><span class='details' title='"+$(r).text()+"'>"+$(r).text()+"<\/span><div style='width:auto' class='instant-cancel'><span class='su su-close i-selected-cancel'/><\/div><\/div>"),$("#selected-users-validation").css("visibility","hidden"),e=$("<div>").attr("id",$(r).val()).attr("data-searchtype","userSearch").addClass("SelectedShareItems"),$("#selected-users").children().each(function(){var n=$(this).attr("id");t.push(n)}),t.length!=0&&t.includes(e.attr("id"))||$("#selected-users").append(f);else{if(r=i,$(".SelectedShareItems[id='"+$(r).val()+"']").length>1)for(u=0;u<$(".SelectedShareItems[id='"+$(r).val()+"']").length;u++)$($(".SelectedShareItems[id='"+$(r).val()+"']")[u]).attr("data-searchtype")=="userSearch"&&$($(".SelectedShareItems[id='"+$(r).val()+"']")[u]).remove();else $(".SelectedShareItems[id='"+$(r).val()+"']").remove();$($("#user-search-container .bs-deselect-all-custom").children("span")[0]).text(window.Server.App.Localization.Select);$("#user-search-container .bs-deselect-all-custom").removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom")}});selectedItemsCount();n.stopPropagation()});$(document).on("change","#group-search",function(n){var t=[],i,r;$("#group-search-container").addClass("value-changed");i=$("#group-search-container .bootstrap-select li.selected").length;r=$("#group-search-container .bootstrap-select li").length;i==r&&($($("#group-search-container div.bs-select-all-custom").children("span")[0]).text(window.Server.App.Localization.Clear),$("#group-search-container div.bs-select-all-custom").removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom"));$(this).find("option").each(function(n,i){var f,r,u;$(this).is(":selected")?(r=i,f=$("<div>").attr("id",$(r).val()).attr("data-searchtype","groupSearch").addClass("SelectedShareItems"),f.html("<div class='InstantSearch'><span class='details' title='"+$(r).text()+"'>"+$(r).text()+"<\/span><div style='width:auto' class='instant-cancel'><span class='su su-close i-selected-cancel'/><\/div><\/div>"),$("#selected-users-validation").css("visibility","hidden"),$("#selected-users-validation").css("visibility","hidden"),u=$("<div>").attr("id",$(r).val()).attr("data-searchtype","groupSearch").addClass("SelectedShareItems"),$("#selected-users").children().each(function(){var n=$(this).attr("id");t.push(n)}),t.length!=0&&t.includes(u.attr("id"))||$("#selected-users").append(f)):(r=i,u=$("<div>").attr("id",$(r).val()).attr("data-searchtype","groupSearch").addClass("SelectedShareItems"),t.pop(u.attr("id")),$(".SelectedShareItems").filter("[data-searchtype='groupSearch']").filter("#"+$(r).val()).remove(),$($("#group-search-container .bs-deselect-all-custom").children("span")[0]).text(window.Server.App.Localization.Select),$("#group-search-container .bs-deselect-all-custom").removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom"))});selectedItemsCount();n.stopPropagation()});$(document).on("click","#subscribers-panel .i-selected-cancel",function(){var t=$(this).parents(".SelectedShareItems").attr("id"),n=$(this).parents(".SelectedShareItems").attr("data-searchtype");n=="userSearch"?(currentElementIndex=$("#user-search").find("[value='"+t+"']").index(),$("#user-search-container .bootstrap-select li").filter("[data-original-index='"+currentElementIndex+"']").find("a").click()):n=="groupSearch"?(currentElementIndex=$("#group-search").find("[value='"+t+"']").index(),$("#group-search-container .bootstrap-select li").filter("[data-original-index='"+currentElementIndex+"']").find("a").click()):n=="externalRecipient"&&$(this).parent().parent().parent().remove();selectedItemsCount();$("#selected_childdashboard").attr("disabled",!1)});$(document).on("hide.bs.dropdown","#user-search-container",function(n){$("#user-search-container").hasClass("value-changed")&&($("#user-search-container").removeClass("value-changed"),n.stopPropagation())});$(document).on("hide.bs.dropdown","#group-search-container",function(n){$("#group-search-container").hasClass("value-changed")&&($("#group-search-container").removeClass("value-changed"),n.stopPropagation())});$(document).on("show.bs.dropdown","#user-search-container",function(){$("#user-search").next("div").find(".dropdown-menu").addClass("dropdown-width");for(var n=0;n<$("#user-search option").length;n++)$("#user-search option").eq(n).attr("data-show").toLowerCase()=="false"&&($("#user-search-container .dropdown-menu .inner li").eq(n).addClass("disabled user-disabled"),$("#user-search-container .dropdown-menu .inner li").eq(n).attr("data-toggle","tooltip").attr("data-placement","top").attr("data-original-title",window.Server.App.Localization.AutoGeneratedMail)),$('[data-toggle="tooltip"]').tooltip()});$(document).on("show.bs.dropdown","#group-search-container",function(){$("#group-search").next("div").find(".dropdown-menu").addClass("dropdown-width")});$(document).on("click","#schedule-submit",function(n){var g,t,p,w,l,r;validateSubscriber();var f=" ",e="",u="";alertChange==2&&(f=window.Server.App.Localization.ConditionEvaluted,successMessage=window.Server.App.Localization.DataAlertConfigureSuccess,e=window.Server.App.Localization.DataAlertConfigureSuccessMessage,g=$(".time-width").val());t={};t.ScheduleName=$("#schedule-name").val();t.ItemId=$(this).attr("data-report-id");t.ExportType=$("input[name=exportFormats]:checked","#export-format-container").val().toString();actionType=="Create"?(successMessage=window.Server.App.Localization.DashboardScheduleSuccess,u=addScheduleUrl,schedulePermisionWarningMessage=window.Server.App.Localization.AddSchedulePermissionWarningAlert):(successMessage=window.Server.App.Localization.ScheduleUpdateSuccess,t.ScheduleId=$(this).attr("data-schedule-id"),t.FailureOccurrence=scheduleRecurrenceInfo.FailureOccurrence,u=updateScheduleUrl,schedulePermisionWarningMessage=window.Server.App.Localization.UpdateSchedulePermissionWarningAlert);p=t.ExportType.toLowerCase();p=="image"?(t.ImageFormat=$("#image-format").val(),t.ImageResolution=$("#image-dpi").val()):p=="pdf"?(t.PdfSize=$("#pdf-format").val(),w="",w=$("#pdf-portrait").hasClass("selected-pdf-orientation")?"Portrait":"Landscape",t.PdfOrientation=w):t.ExcelFormat=$("#excel-format").val();var o="",s="",h="",c="";o=scheduleEmailEditRTE.value;o=getRelativePath(o);alertChange==2&&(s=filterContent.Filters,h=filterContent.DaJsonString,c=filterContent.DataSourceId);t.EmailContent=o;t.EmailSubject=$("#subject-area").val();l=$("#alert-value").text();switch($("#recurrence-type").val().toString().toLowerCase()){case"daily":$("#daily-every-x-days").prop("checked")?(t.RecurrenceType="Daily",t.RecurrenceInterval=$("#every-x-days").val()):t.RecurrenceType="DailyWeekDay";break;case"weekly":t.RecurrenceType="Weekly";t.RecurrenceInterval=$("#every-x-weeks").val();t.Sunday=$("#sun").prop("checked");t.Monday=$("#mon").prop("checked");t.Tuesday=$("#tues").prop("checked");t.Wednesday=$("#wed").prop("checked");t.Thursday=$("#thu").prop("checked");t.Friday=$("#fri").prop("checked");t.Saturday=$("#sat").prop("checked");break;case"monthly":$("#monthly").prop("checked")?(t.RecurrenceType="Monthly",t.DaysOfMonth=$("#monthly-date").val(),t.RecurrenceInterval=$("#monthly-every-x-months").val()):(t.RecurrenceType="MonthlyDOW",t.WeekOfMonth=$("#monthly-dow-week").find("option:selected").text(),t.DayOfWeek=$("#monthly-dow-day").find("option:selected").text(),t.RecurrenceInterval=$("#monthly-dow-every-x-months").val());break;case"yearly":t.RecurrenceInterval=$("#every-x-years").val();$("#yearly").prop("checked")?(t.RecurrenceType="Yearly",t.DaysOfMonth=$("#yearly-day").val(),t.MonthOfYear=$("#yearly-month").find("option:selected").text()):(t.RecurrenceType="YearlyDOW",t.WeekOfMonth=$("#yearly-dow-week").find("option:selected").text(),t.DayOfWeek=$("#yearly-dow-day").find("option:selected").text(),t.MonthOfYear=$("#yearly-dow-month").find("option:selected").text());break;case"hourly":t.RecurrenceType="Hourly";t.Frequency=$(".time-width").val();t.RecurrenceInterval=$("#every-x-hours-value").val()}t.IsEnabled=$("#enable-schedule").prop("checked");t.FailureNotificationToOwner=$("#enable-notification-to-owner").prop("checked");t.FailureNotificationToRecipient=$("#enable-notification-to-recipient").prop("checked");t.StartDate=$("#start-date").val();switch($("input[name=end-type]:checked","#schedule-end-type").val().toString()){case"never":t.ScheduleEndType="NoEnd";break;case"endafter":t.ScheduleEndType="EndAfter";t.RecurrenceFactor=$("#occurence-count").val();break;case"endBy":t.ScheduleEndType="EndBy";t.EndDate=$("#end-date").val()}var i=$(".selected-recipients").children(),a=Array(),v=Array(),y=Array(),b=0,k=0,d=0;for(r=0;r<i.length;r++)i[r].getAttribute("data-searchtype")=="userSearch"&&b!=-1&&(a[b]=i[r].id,b++),i[r].getAttribute("data-searchtype")=="groupSearch"&&k!=-1&&(v[k]=i[r].id,k++),i[r].getAttribute("data-searchtype")=="externalRecipient"&&d!=-1&&(y[d]=i[r].id,d++);if($("#export-destination").prop("checked"))if($("#ftp-destination").prop("checked"))t.IsFTPExportOptionEnabled=$("#ftp-destination").prop("checked"),t.FtpURL=$("#host-name").val(),t.FtpUsername=$("#user-name").val(),t.FtpPassword=$("#password").val(),FTPCredentialsValidation(n),$("#host-name").val()!=""&&$("#user-name").val()!=""&&$("#password").val()!=""&&$.ajax({type:"POST",url:validateFTPCredentials,data:{hostName:$("#host-name").val(),username:$("#user-name").val(),password:$("#password").val()},beforeSend:function(){parent.$("#popup-container_wrapper").ejWaitingPopup("show");parent.$("#editpopup-container_wrapper").ejWaitingPopup("show")},success:function(n){var r=n.ErrorMessage!=undefined?n.ErrorMessage:"";parent.$("#popup-container_wrapper").ejWaitingPopup("hide");parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide");n.IsFtpCredentialsAreValid?scheduleSubmit(i,l,f,e,u,t,a,v,y,s,h,c):$("#ftp-validation-message").text(r).addClass("ftp-credentials-validation-message")}});else{if(isNullOrWhitespace($("#webhook-option").val())){$("#webhook-select-validations").css("display","block").html(window.Server.App.Localization.SelectWebhook);return}t.IsWebhookOptionEnabled=$("#webhook-destination").prop("checked");t.WebhookName=$(".select-webhook-div .filter-option").html();t.WebhookId=$("#webhook-option option:selected").val();scheduleSubmit(i,l,f,e,u,t,a,v,y,s,h,c)}else scheduleSubmit(i,l,f,e,u,t,a,v,y,s,h,c)});$(".show-hide-password").on("mousedown",function(){$(this).siblings("input").is(":password")?$(this).siblings("input").attr("type","text"):$(this).siblings("input").attr("type","password")});$(".show-hide-password").on("mouseup",function(){$(this).siblings("input").is(":password")?$(this).siblings("input").attr("type","text"):$(this).siblings("input").attr("type","password")});$(document).on("focusout","#host-name, #user-name, #password",function(n){FTPCredentialsValidation(n)});$(document).on("keyup","#host-name",function(){$("#host-name").closest("div").removeClass("has-error");$("#host-name").closest("div").find("span").html("").hide();$("#ftp-validation-message").text("").removeClass("ftp-credentials-validation-message")});$(document).on("keyup","#user-name",function(){$("#user-name").closest("div").removeClass("has-error");$("#user-name").closest("div").find("span").html("").hide();$("#ftp-validation-message").text("").removeClass("ftp-credentials-validation-message")});$(document).on("keyup","#password",function(){$("#password").closest("div").removeClass("has-error");$("#password").closest("div").find("span").html("").hide();$("#ftp-validation-message").text("").removeClass("ftp-credentials-validation-message")});$("#webhook-option").on("change",function(n){$("#webhook-select-validations").css("display","none");n.stopPropagation();$.ajax({type:"POST",url:getWebhookDetailsByIdUrl,data:{webhookId:$("#webhook-option option:selected").val()},success:function(n){$("#webhook-info").css("display","block");$("#webhook-info span").html(window.Server.App.Localization.WebhookInfoMessage.format("<b>"+n.data.Url+"<\/b>","<b>"+n.data.ContentTypeDescription+"<\/b>","POST"))}})});$(document).ready(function(){var i,r,u,f,n,e,o,t,s,h;if($(".schedule-dialog #subscribers-panel").css("display","inline"),getAllStaticData(),$('[data-toggle="tooltip"]').tooltip(),actionType=="Create")$("select#user-search option").each(function(){var n,t;$(this).val()!=""&&$(this).val().toLowerCase()==$("#userName").val().toLowerCase()&&(n=$(this).text(),$(this).attr("selected",!0),$("#user-search").selectpicker("refresh"),t=$("<div>").attr("id",$(this).val()).attr("data-searchtype","userSearch").addClass("SelectedShareItems"),t.html("<div class='InstantSearch'><span class='details' title='"+n+"'>"+n+"<\/span><div style='width:auto' class='instant-cancel'><span class='su su-close i-selected-cancel'/><\/div><\/div>"),$("#selected-users").append(t))}),canExport.Image?($("#image-export").prop("checked",!0),$("#show-excel-format").hide(),$("#show-image-format").show(),$("#show-pdf-format").hide()):canExport.Pdf?($("#pdf-export").prop("checked",!0),$("#show-excel-format").hide(),$("#show-image-format").hide(),$("#show-pdf-format").show()):canExport.Excel&&($("#excel-export").prop("checked",!0),$("#show-excel-format").show(),$("#show-image-format").hide(),$("#show-pdf-format").hide());else{for(n=0;n<subscriberUser.length;n++)$("#user-search option[value='"+subscriberUser[n]+"']").attr("selected",!0),$("#user-search").selectpicker("refresh"),i=$("#user-search option[value='"+subscriberUser[n]+"']").text(),r=$("<div>").attr("id",subscriberUser[n]).attr("data-searchtype","userSearch").addClass("SelectedShareItems"),r.html("<div class='InstantSearch'><span class='details' title='"+i.trim()+"'>"+i.trim()+"<\/span><div style='width:auto' class='instant-cancel'><span class='su su-close i-selected-cancel'/><\/div><\/div>"),$("#selected-users").append(r);for(oldUserSelected=$("#user-search").val(),n=0;n<subscriberGroup.length;n++)$("#group-search option[value='"+subscriberGroup[n]+"']").attr("selected",!0),$("#group-search").selectpicker("refresh"),u=$("#group-search option[value='"+subscriberGroup[n]+"']").text(),f=$("<div>").attr("id",subscriberGroup[n]).attr("data-searchtype","groupSearch").addClass("SelectedShareItems"),f.html("<div class='InstantSearch'><span class='details' title='"+u.trim()+"'>"+u.trim()+"<\/span><div style='width:auto' class='instant-cancel'><span class='su su-close i-selected-cancel'/><\/div><\/div>"),$("#selected-users").append(f);for(oldGroupSelected=$("#group-search").val(),n=0;n<subscriberExternalRecipient.length;n++)e=subscriberExternalRecipient[n],o=$("<div>").attr("id",subscriberExternalRecipient[n]).attr("data-searchtype","externalRecipient").addClass("SelectedShareItems"),o.html("<div class='InstantSearch'><span class='details'title='"+e+"'>"+e+"<\/span><div style='width:auto' class='instant-cancel'><span class='su su-close i-selected-cancel'/><\/div><\/div>"),$("#selected-users").append(o);var c=$("#group-search-container .bootstrap-select li.selected").length,l=$("#group-search-container .bootstrap-select li").length,a=$("#user-search-container .bootstrap-select li.selected").length,v=$("#user-search-container .bootstrap-select li").length;c===l&&$("#group-search-container .bs-select-all-custom").removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom");a===v&&$("#user-search-container .bs-select-all-custom").removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom");$("#image-export").prop("checked",exportType.toLowerCase()=="image");$("#pdf-export").prop("checked",exportType.toLowerCase()=="pdf");$("#excel-export").prop("checked",exportType.toLowerCase()=="excel");t=scheduleExportInfo.ExportFormatInfo;$("#schedule-submit").attr("data-schedule-id",scheduleId);exportType.toLowerCase()=="image"&&canExport.Image?($("#image-export").prop("checked",exportType.toLowerCase()=="image"),$("#show-excel-format").hide(),$("#show-image-format").show(),$("#show-pdf-format").hide(),$("#image-format").val(t.Extension).change(),$("#image-dpi").val(t.Resolution)):exportType.toLowerCase()=="pdf"&&canExport.Pdf?($("#pdf-export").prop("checked",exportType.toLowerCase()=="pdf"),$("#show-excel-format").hide(),$("#show-image-format").hide(),$("#show-pdf-format").show(),t.Size=="A3"||t.Size=="A4"||t.Size=="A5"||t.Size=="Letter"?$("#pdf-format").val(t.Size).change():$("#pdf-format").val("A4").change(),t.Orientation=="Portrait"?($("#pdf-portrait").addClass("selected-pdf-orientation"),$("#pdf-landscape").removeClass("selected-pdf-orientation")):($("#pdf-portrait").removeClass("selected-pdf-orientation"),$("#pdf-landscape").addClass("selected-pdf-orientation"))):($("#excel-export").prop("checked",exportType.toLowerCase()=="excel"||canExport.Excel),$("#show-excel-format").show(),$("#show-image-format").hide(),$("#show-pdf-format").hide(),t.Extension=="xlsx"||t.Extension=="xls"?$("#excel-format").val(t.Extension).change():$("#excel-format").val("xlsx").change())}scheduleRecurrenceInfo.FailureNotificationToOwner&&$("#enable-notification-to-owner").prop("checked",!0);scheduleRecurrenceInfo.FailureNotificationToRecipient&&$("#enable-notification-to-recipient").prop("checked",!0);scheduleExportInfo.ScheduleExportLocation!=undefined&&scheduleExportInfo.ScheduleExportLocation!=null&&scheduleExportInfo.ScheduleExportLocation.IsFTPExportOptionEnabled?($("#ftp-destination, #webhook-destination").attr("disabled",!1),$("#export-destination").prop("checked",!0),$("#ftp-destination").prop("checked",!0),$(".webhook-location-div").removeClass("show").addClass("hide"),$(".ftp-location-div").removeClass("hide").addClass("show"),$("#host-name, #user-name, #password").attr("disabled",!1),$("#host-name").val(scheduleExportInfo.ScheduleExportLocation.FtpURL),$("#user-name").val(scheduleExportInfo.ScheduleExportLocation.FtpUsername)):scheduleExportInfo.ScheduleExportLocation!=undefined&&scheduleExportInfo.ScheduleExportLocation!=null&&scheduleExportInfo.ScheduleExportLocation.IsWebhookOptionEnabled&&($("#export-destination").prop("checked",!0),$("#webhook-destination").prop("checked",!0),$(".webhook-location-div").removeClass("hide").addClass("show"),$(".ftp-location-div").removeClass("show").addClass("hide"),$("#ftp-destination, #webhook-destination").attr("disabled",!1),$(".select-webhook-div .selectpicker").removeClass("disabled"),$("#create-webhook").removeClass("disabled"),$("#webhook-option, #refresh-webhook").attr("disabled",!1),$("#webhook-option").find("option").remove(),$("#webhook-option").selectpicker("refresh"),$(".select-webhook-div .filter-option").html(scheduleExportInfo.ScheduleExportLocation.WebhookName),listWebhooks="",s=!0,h=alertChange==2?webhookevent[1]:webhookevent[0],$.ajax({type:"POST",url:getWebhooksUrl,data:{webhookEventType:h},success:function(n){var t=n,i,r;for(listWebhooks="<option value='' data-hidden='true'><\/option>",i=0;i<t.data.length;i++)listWebhooks+='<option value="'+t.data[i].Id+'">'+t.data[i].Name+"<\/option>";for($("#webhook-option").html(""),$("#webhook-option").html(listWebhooks),r=0;r<t.data.length;r++)scheduleExportInfo.ScheduleExportLocation.WebhookId==t.data[r].Id&&($("#webhook-option option[value='"+t.data[r].Id+"']").attr("selected",!0),s=!1);$(".select-webhook-div.bootstrap-select ul li").each(function(){$(this).hasClass("selected")&&$(this).addClass("active")});s||$.ajax({type:"POST",url:getWebhookDetailsByIdUrl,data:{webhookId:scheduleExportInfo.ScheduleExportLocation.WebhookId},success:function(n){$("#webhook-info").css("display","block");$("#webhook-info span").html(window.Server.App.Localization.WebhookInfoMessage.format("<b>"+n.data.Url+"<\/b>","<b>"+n.data.ContentTypeDescription+"<\/b>","POST"))}})}}));selectedItemsCount();validateExternalRecipient();addTitleForUsersAndGroups();parent.$("#popup-container_wrapper").ejWaitingPopup("hide");parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide")});$(document).on("show.bs.dropdown",".select-webhook-div",function(){isNullOrWhitespace($("#webhook-option option:selected").val())?!isNullOrWhitespace(scheduleExportInfo.ScheduleExportLocation)&&scheduleExportInfo.ScheduleExportLocation.IsWebhookOptionEnabled?LoadWebhookName(scheduleExportInfo.ScheduleExportLocation.WebhookId):LoadWebhookName():LoadWebhookName($("#webhook-option option:selected").val())})