var bbdesigner$=$,uploadInstance=(void 0!==window.bb$&&(bbdesigner$=window.bb$),null);function doneBtnClick(a){this.uploadInstance.validateAndSave()}function onBackBtnClick(a){showNextButton(!0),this.uploadInstance.navigateBackwards()}function onNextBtnClick(a){this.uploadInstance.initiateUpload();var t=$("#upload_item_dialog").is(":visible")?"upload_item_dialog":"upload_item_status_dialog";ejs.popups.createSpinner({target:document.getElementById(t)}),ejs.popups.setSpinner({type:"Material"}),ejs.popups.showSpinner(document.getElementById(t))}function onActionBegin(a){"initiateUpload"===a.eventType&&updateStatus(a.source.data)}function updateStatus(a){$.ajax({type:"POST",url:updateUploadStatusUrl,data:{uploadStatusData:JSON.stringify(a)},success:function(a){a.Status&&onUploadStatusClick()}})}function onActionComplete(a){switch(a.eventType){case"navigate":"datasourceConfiguration"===a.source.data.target?(t=$("#upload_item_dialog").is(":visible")?"upload_item_dialog":"upload_item_status_dialog",(e=document.getElementById(t).ej2_instances)[0].header='<span class="dialog-header-with-icon"><span class ="dialog-header-title">'+window.Server.App.Localization.DatSourceMapping.format(window.Server.App.Localization.UploadDashboard)+"</span></span>",e[0].buttons=[{click:function(a){onBackBtnClick()},buttonModel:{cssClass:"app-btn-secondary pull-left",content:window.Server.App.Localization.Back}},{click:function(){doneBtnClick()},buttonModel:{isPrimary:!0,cssClass:"app-btn-primary",content:window.Server.App.Localization.DoneButton}}],e[0].show()):"datasourceListing"===a.source.data.target&&showNextButton(!0);break;case"uploadDatasourceConfig":a.source.data.configurationComplete?showNextButton(!1):showNextButton(!0);break;case"isValidFile":var t,e;a.source.data.isValidFile?(updateFileValidation(),t=$("#upload_item_dialog").is(":visible")?"upload_item_dialog":"upload_item_status_dialog",(e=document.getElementById(t).ej2_instances)[0].header='<span class="dialog-header-with-icon"><span class ="dialog-header-title">'+window.Server.App.Localization.DatSourceMapping.format(window.Server.App.Localization.UploadDashboard)+"</span></span>"):uploadDashboardItem(!0)}}function showNextButton(a){var t=$("#upload_item_dialog").is(":visible")?"upload_item_dialog":"upload_item_status_dialog",e=document.getElementById(t).ej2_instances;e[0].header='<span class="dialog-header-with-icon"><span class ="dialog-header-title">'+window.Server.App.Localization.DatSourceMapping.format(window.Server.App.Localization.UploadDashboard)+"</span></span>",e[0].buttons=[{click:function(a){onNextBtnClick()},buttonModel:{isPrimary:!0,cssClass:"app-btn-primary",disabled:a,content:window.Server.App.Localization.Next}},{click:function(){$("#uploaddashbord-id").val(""),e[0].hide(),parent.document.getElementById("upload-popup-container").style.display="none",parent.document.getElementById("common-overlay").style.display="none",refreshListingPage()},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.Localization.CancelButton}}],e[0].show()}$(document).ready(function(){var a=$('meta[name="designer_service:url"]').attr("content"),t=$('meta[name="dashboard_service:url"]').attr("content"),e=$('meta[name="dashboard:id"]').attr("content"),n=$('meta[name="category:id"]').attr("content"),o=$('meta[name="dashboard:name"]').attr("content"),i=$('meta[name="dashboard:description"]').attr("content"),t={serverUrl:t,serviceAuthorizationToken:$('meta[name="access:token"]').attr("content"),serviceUrl:a,uploadId:e,name:o,description:i,categoryId:n,canCreateDS:canCreateDS,environment:isSelfHosted?"onpremise":"cloud",actionBegin:bbdesigner$.proxy(onActionBegin,this),actionComplete:bbdesigner$.proxy(onActionComplete,this)};uploadInstance=new BoldBIDashboard.Upload($("#data_source_mapping"),t)});